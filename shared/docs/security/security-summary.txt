â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           DEPLOYMENT SECURITY AUDIT - EXECUTIVE SUMMARY                    â•‘
â•‘              Developer Hub Platform - GCP Learning Project                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OVERALL SECURITY RATING: 6.5/10
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

STATUS FOR LEARNING PROJECT: âœ… ACCEPTABLE (with documented vulnerabilities)
STATUS FOR PRODUCTION: âŒ NOT READY (critical issues must be fixed)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CRITICAL VULNERABILITIES (Fix Immediately)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸ”´ CRITICAL-1] CORS WILDCARD CONFIGURATION
  Files: PortfolioController.java (line 22)
         SnippetsController.java (line 25)
         application.properties
  Issue: @CrossOrigin(origins = "*") allows ANY domain
  Risk: CSRF attacks, unauthorized data access, MITM attacks
  Fix: Restrict to specific domains only

[ğŸ”´ CRITICAL-2] NO HTTPS ENFORCEMENT
  File: ingress.yaml
  Issue: HTTP-only ingress, no SSL/TLS configuration
  Risk: Man-in-the-middle attacks, traffic interception
  Fix: Enable managed-certificates, force HTTPS redirect

[ğŸ”´ CRITICAL-3] PUBLIC BUCKET ACCESS
  File: frontend-deploy.yml (line 72)
  Issue: "gsutil iam ch allUsers:objectViewer" makes bucket publicly readable
  Note: This is INTENTIONAL for frontend hosting
  Risk: No access control (acceptable for public frontend only)
  Action: Document this design decision

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
HIGH PRIORITY ISSUES (Fix Before Production)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸŸ  HIGH-1] IMAGE VERSION NOT PINNED
  File: deployment.yaml (line 26)
  Issue: Using "latest" tag - no reproducibility, hard to rollback
  Fix: Use commit SHA ($GITHUB_SHA) instead of "latest"
  Also: Pin base images in Dockerfile to specific digests

[ğŸŸ  HIGH-2] NO NETWORK POLICIES
  Status: Not implemented
  Risk: Any pod can communicate with any other pod
  Fix: Create NetworkPolicy to restrict traffic flows

[ğŸŸ  HIGH-3] INCOMPLETE SECURITY CONTEXT
  File: deployment.yaml (lines 83-86)
  Missing: 
    - readOnlyRootFilesystem: true
    - allowPrivilegeEscalation: false
    - capabilities.drop: ["ALL"]
  Fix: Add these fields to reduce attack surface

[ğŸŸ  HIGH-4] NO POD SECURITY STANDARDS
  Status: Not enforced
  Risk: No cluster-level security policy enforcement
  Fix: Enable restricted PSS in namespace

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MEDIUM PRIORITY ISSUES (Fix Before GA Release)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ğŸŸ¡ MEDIUM-1] NO IMAGE SCANNING
  Files: backend-deploy.yml, frontend-deploy.yml
  Issue: No vulnerability scanning in CI/CD pipeline
  Fix: Add Trivy or Snyk scanning, fail on HIGH/CRITICAL

[ğŸŸ¡ MEDIUM-2] imagePullPolicy NOT SPECIFIED
  File: deployment.yaml
  Issue: Default behavior may cache old images
  Fix: Set explicitly to "IfNotPresent"

[ğŸŸ¡ MEDIUM-3] NO AUDIT LOGGING
  Status: Not configured
  Issue: No logging of API access or cluster events
  Fix: Enable GKE audit logging

[ğŸŸ¡ MEDIUM-4] ENVIRONMENT VARIABLES PLAINTEXT
  File: deployment.yaml
  Issue: GCS_BUCKET and GCP_PROJECT_ID as env vars (not secrets)
  Note: These are non-sensitive, but should use K8s Secrets
  Fix: Move to Kubernetes Secrets with valueFrom

[ğŸŸ¡ MEDIUM-5] INGRESS NOT RESTRICTED
  File: ingress.yaml
  Issue: defaultBackend accepts all traffic
  Fix: Configure ingress rules with host/path restrictions

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SECURITY STRENGTHS âœ…
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… EXCELLENT: Workload Identity Federation (no JSON keys in GitHub)
âœ… EXCELLENT: No hardcoded credentials anywhere
âœ… EXCELLENT: Comprehensive .gitignore for secrets
âœ… EXCELLENT: Multi-stage Docker build
âœ… EXCELLENT: Non-root user in container (UID 1000)
âœ… EXCELLENT: Resource limits enforced (free tier safe)
âœ… GOOD: Health checks configured (liveness, readiness, startup)
âœ… GOOD: Tests run before deployment
âœ… GOOD: Alpine base image (smaller attack surface)
âœ… GOOD: Proper permissions scoping in GitHub Actions
âœ… GOOD: Maven tests executed in CI/CD

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SECURITY GAPS âŒ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âŒ No container vulnerability scanning
âŒ No network policies
âŒ No pod security standards enforced
âŒ No HTTPS/TLS on ingress
âŒ No image version pinning
âŒ CORS not restricted
âŒ No rate limiting
âŒ No audit logging
âŒ No binary authorization
âŒ No secrets encryption at rest

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FILE SECURITY SCORES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Kubernetes:
  workload-identity.yaml ........... 10/10 âœ…âœ…âœ…
  service.yaml ..................... 9/10 âœ…âœ…
  deployment.yaml .................. 7/10 âœ…
  ingress.yaml ..................... 4/10 âŒ

CI/CD:
  backend-deploy.yml ............... 8/10 âœ…âœ…
  frontend-deploy.yml .............. 7/10 âœ…

Application:
  Dockerfile ....................... 8/10 âœ…âœ…
  PortfolioController.java ......... 6/10 âŒ (CORS issue)
  SnippetsController.java .......... 6/10 âŒ (CORS issue)
  application.properties ........... 6/10 âŒ (CORS issue)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
REQUIRED GITHUB SECRETS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Properly stored in GitHub Secrets (not in code):
   - GCP_PROJECT_ID
   - GKE_CLUSTER
   - GKE_REGION
   - ARTIFACT_REGISTRY
   - WIF_PROVIDER (Workload Identity Federation)
   - WIF_SERVICE_ACCOUNT
   - FRONTEND_BUCKET
   - API_URL

âœ… NO service account JSON keys stored anywhere
âœ… Using OIDC token exchange (Workload Identity Federation)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
QUICK FIX CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

IMMEDIATE (1-2 hours):
  â–¡ Change CORS from "*" to specific domains
  â–¡ Document that frontend bucket is intentionally public
  â–¡ Enable HTTPS on ingress (create SSL cert)

SHORT TERM (2-4 hours):
  â–¡ Pin image tags to commit SHA instead of "latest"
  â–¡ Add imagePullPolicy: IfNotPresent
  â–¡ Complete security context (readOnlyRootFilesystem, etc.)

BEFORE PRODUCTION (1-2 days):
  â–¡ Implement NetworkPolicy
  â–¡ Enforce Pod Security Standards
  â–¡ Add container vulnerability scanning
  â–¡ Create dedicated namespace
  â–¡ Configure RBAC
  â–¡ Enable audit logging

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DIRECTORY STRUCTURE ANALYZED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/home/user/gcp/deploy/
â”œâ”€â”€ kubernetes/
â”‚   â”œâ”€â”€ deployment.yaml ........... [K8s Pod Deployment]
â”‚   â”œâ”€â”€ service.yaml .............. [K8s Service]
â”‚   â”œâ”€â”€ ingress.yaml .............. [K8s Ingress Controller]
â”‚   â””â”€â”€ workload-identity.yaml .... [K8s Service Account + WIF]
â”œâ”€â”€ ci-cd/
â”‚   â”œâ”€â”€ backend-deploy.yml ........ [GitHub Actions - Backend]
â”‚   â””â”€â”€ frontend-deploy.yml ....... [GitHub Actions - Frontend]
â””â”€â”€ (no gcp/ or other configs found)

/home/user/gcp/.github/workflows/
â”œâ”€â”€ backend-deploy.yml
â””â”€â”€ frontend-deploy.yml

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
METRICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Total Files Analyzed: 10
  - Kubernetes YAML: 4
  - GitHub Actions: 2
  - Docker: 1
  - Application Config: 2
  - Application Code: 2 (controllers)

Total Lines Analyzed: 327 (YAML) + 200+ (Java)

Vulnerabilities Found:
  - Critical: 3
  - High: 4
  - Medium: 5
  - Low: 2

No Hardcoded Secrets Found: âœ…

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ESTIMATED REMEDIATION EFFORT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Critical Issues:         4-6 hours
High Priority Issues:   8-12 hours
Medium Priority Issues: 12-16 hours
Low Priority Issues:    4-8 hours
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TOTAL:                  28-42 hours (3-5 days of focused work)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
COMPLIANCE STATUS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

OWASP Top 10:
  A01:2021 - Broken Access Control ................. âŒ (CORS issue)
  A02:2021 - Cryptographic Failures ................ âŒ (No HTTPS)
  A03:2021 - Injection ............................ âœ… (Input validation)
  A04:2021 - Insecure Design ...................... âš ï¸ (No security design)
  A05:2021 - Security Misconfiguration ............ âŒ (Multiple)
  A06:2021 - Vulnerable Components ................ âš ï¸ (No scanning)
  A07:2021 - Authentication Failures ............. âœ… (Workload Identity)
  A08:2021 - Software & Data Integrity ........... âš ï¸ (No binary auth)
  A09:2021 - Logging & Monitoring ................ âŒ (No audit logs)
  A10:2021 - SSRF ................................ âœ… (Not applicable)

CIS Kubernetes Benchmarks:
  Cluster Setup: âŒ (No PSS, No audit logging)
  Workload Security: âš ï¸ (Partial security context)
  Network Security: âŒ (No network policies)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NEXT STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. IMMEDIATE:
   - Review this report with the team
   - Create issues for critical items
   - Schedule security fix sprint

2. SHORT TERM (This week):
   - Address CORS wildcard
   - Enable HTTPS on ingress
   - Pin image versions

3. MEDIUM TERM (This month):
   - Implement network policies
   - Add image scanning
   - Enable audit logging

4. ONGOING:
   - Regular security audits
   - Dependency scanning
   - Penetration testing (if production)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Report Generated: 2025-11-16
Full Report: /tmp/security-audit-report.md
Contact: Claude Code Security Analysis

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
